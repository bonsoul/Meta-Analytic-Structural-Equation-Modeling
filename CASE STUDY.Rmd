---
title: "PROJOJECT"
author: "Bonsoul"
date: "2025-08-19"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("skimr")
```


```{r}
library(readr)
library(dplyr)
library(tidyverse)
library(VIM)
library(naniar)
library(DataExplorer)
library(corrplot)
library(GGally)
library(skimr)
```

```{r}

df <- read_csv("psyco.csv")
colnames(df)
```

```{r}
str(df)
summary(df)

```

```{r}

# Assuming your dataset is already read into df
df <- df %>%
  # Fix age â†’ factor
  mutate(age = factor(age),
         gender = factor(gender),
         occupation = factor(occupation),
         line_of_work = factor(line_of_work),
         prefer = factor(prefer),
         certaindays_hw = factor(certaindays_hw)) %>%
  
  # Drop useless columns
  select(-`...20`, -`travel+work`) %>%
  
  # Rename confusing columns
  rename(time_bp = `time_bp...5`,
         time_bp2 = `time_bp...21`) %>%
  
  # Ensure numeric columns are numeric
  mutate(across(c(time_bp, time_dp, travel_time, easeof_online, home_env,
                  prod_inc, sleep_bal, new_skill, fam_connect, relaxed,
                  self_time), as.numeric)) %>%
  
  # Check for odd encodings in like_hw and dislike_hw
  mutate(like_hw = as.character(like_hw),
         dislike_hw = as.character(dislike_hw))

# Quick check
str(df)
summary(df)

```



```{r}
vis_miss(df)
skim(df)
```


```{r}
# Count total missing values in the dataset
sum(is.na(df))


# Percentage of missing values per column
colMeans(is.na(df)) * 100

```

```{r}
df1 <- df[, colSums(is.na(df)) < nrow(df)]
```


```{r}
categorical_vars <- c("gender", "occupation", "like_hw", "dislike_hw", "prefer")
for (var in categorical_vars) {
  print(
    ggplot(df1, aes(x = .data[[var]])) +
      geom_bar(fill = "steelblue") +
      theme_minimal() +
      ggtitle(paste("Distribution of", var))
  )
}
```


```{r}
# Select only numeric columns
numeric_df <- df1 %>% select(where(is.numeric))



numeric_df %>%
  pivot_longer(cols = everything(), names_to = "variable", values_to = "value") %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "white") +
  facet_wrap(~variable, scales = "free", ncol = 3) +
  theme_minimal()
```


```{r}
# 3. Boxplots for outlier detection
numeric_df %>%
  pivot_longer(cols = everything(), names_to = "variable", values_to = "value") %>%
  ggplot(aes(y = value, x = variable, fill = variable)) +
  geom_boxplot(show.legend = FALSE, outlier.color = "red") +
  coord_flip() +
  theme_minimal()
```


```{r}
ggcorr(numeric_df, label = TRUE, label_round = 2, hjust = 0.75, size = 3)
```

```{r}
ggpairs(numeric_df)
```

